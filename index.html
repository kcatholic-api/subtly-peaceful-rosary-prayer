
<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="생각보다 은근히 평안한 묵주 기도 도우미">
    <!--<meta name="author" content="">-->
    <title>생각보다 은근히 평안한 묵주 기도 도우미</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js" integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" integrity="sha512-dPXYcDub/aeb08c63jRq/k6GaKccl256JQy/AnOq7CAnEZ9FzSL9wSbcZkMp4R26vBsMLFYH4kQ67/bbV8XaCQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <link rel="icon" href="favicon.ico">

    <style>
      .prayer-layout {
        display: grid;
        grid-template-rows: minmax(0, 6fr) minmax(0, 4fr);
        min-height: calc(100vh - 160px);
        gap: 1rem;
      }
      .prayer-pane-top {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 0.75rem;
      }
      .prayer-pane-bottom {
        background-color: #ffffff;
        border: 1px solid #dee2e6;
        border-radius: 0.75rem;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
      .prayer-lyric-area {
        flex: 1 1 auto;
        overflow-y: auto;
      }
      .prayer-options-overlay {
        max-width: 320px;
      }
      .prayer-options-overlay #plannerOptionsWrapper {
        background-color: rgba(255, 255, 255, 0.95);
        border-radius: 0.75rem;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        border: 1px solid #dee2e6;
      }
      .prayer-options-overlay #plannerOptions {
        border-top: none;
      }
      body.prayer-mode {
        overflow: hidden;
        height: 100dvh;
        min-height: 100dvh;
      }
      body.prayer-mode main.container-fluid {
        padding: 0;
        height: 100dvh;
        min-height: 100dvh;
        display: flex;
        flex-direction: column;
      }
      body.prayer-mode #plannerView {
        display: none !important;
      }
      body.prayer-mode #prayerView {
        flex: 1 1 auto;
        display: flex !important;
        flex-direction: column;
        position: fixed;
        inset: 0;
        padding: 1rem;
        height: auto;
        background-color: var(--bs-body-bg, #ffffff);
        overflow: hidden;
        z-index: 1000;
      }
      body.prayer-mode .prayer-layout {
        flex: 1 1 auto;
        min-height: 0;
        height: 100%;
        grid-template-rows: minmax(0, 6fr) minmax(0, 4fr);
      }
      body.prayer-mode .prayer-pane-top,
      body.prayer-mode .prayer-pane-bottom {
        min-height: 0;
      }
      body.prayer-mode #notice_div,
      body.prayer-mode #error_div,
      body.prayer-mode #mdrow {
        display: none !important;
      }
      @media (max-width: 767.98px) {
        .prayer-layout {
          min-height: 100%;
        }
        body.prayer-mode .prayer-layout {
          height: 100%;
          min-height: 100%;
        }
        .prayer-pane-top {
          min-height: 240px;
        }
        body.prayer-mode #prayerView {
          padding: 0.5rem;
          padding-bottom: calc(0.5rem + env(safe-area-inset-bottom, 0px));
        }
      }
    </style>
  </head>
  <body>
<nav class="navbar navbar-expand-md navbar-dark bg-dark mb-4" id="mainNavbar">
  <div class="container-fluid">
    <a class="navbar-brand" href="" id="menu_title">묵주 기도 도우미</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
      <ul class="navbar-nav me-auto mb-2 mb-md-0">
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="#" onclick="load_record()">나의 기록</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- First Modal -->
<div class="modal fade" id="startupModal" tabindex="-1" aria-labelledby="startupModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="startupModalLabel"><small><i>생각보다 은근히 평안한</i></small><br/>묵주 기도 도우미</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
      </div>
      <div class="modal-body">
        <p>
        평화를 빕니다!
        </p>
        <p>
        이 웹사이트는 어려운 가톨릭 묵주 기도를 생각보다 편리하고 평안한 기분으로 시도해 볼 수 있는 기능을 제공하여 전 세계 한인 가톨릭 공동체의 형제자매님들께 도움이 되고자 만들어졌습니다.
        </p>
        <small>
        이 웹사이트는 <b>데스크톱</b> 브라우저 환경에 최적화되어 있습니다. 혹시! 모바일에서 열어보셨다면 <i>생각보다 은근히</i> 불편하실 수 있으니, 집에 돌아가신 후 컴퓨터로 다시 방문하시길 권해드립니다.
        </small>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="never_see_startup()">다시 보지 않기</button>
      </div>
    </div>
  </div>
</div>

<!-- Load Modal -->
<div class="modal fade" id="loadModal" tabindex="-1" aria-labelledby="loadModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="loadModalLabel">로컬 브라우저 저장소 불러오기</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
      </div>
      <div class="modal-body">
        <p>
          <small>어떻게 작동 하나요?</small> <a id="readMore3" data-bs-toggle="collapse" href="#moreText3" aria-expanded="false" aria-controls="moreText3"><small>자세히</small></a></small>
          <span id="moreText3" class="collapse"><br/><small>편집기로 작성 중인 Markdown 문서에서 Heading 1 (#) 또는 Heading 2 (##) 가 적용된 문자열을 추출해서 문서 제목으로 간주 합니다. 이 제목을 Key로 정하고 웹 표준 기술인 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API" target="_blank">Web Storage API</a>을 이용하여 전체 Markdown 데이타를 사용중인 디바이스의 웹브라우저에 저장하고 불러 옵니다. 따라서 서버에는 그 어떤 정보도 저장되지 않습니다.</small><br/>
          <small>로컬 브라우저 저장소는 어떤 이유에서건 사라질 수 있습니다. 작성하신 문서는 다운로드 기능을 사용하여 Markdown (확장자.md) 파일로 직접 안전하게 저장해 두시는 것을 권장합니다.</small></span>
        </p>
        <div class="list-group" id="saved">
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
      </div>
    </div>
  </div>
</div>

<main class="container-fluid">
  <div class="row ms-1 me-1">
    <div id="notice_div" class="alert alert-primary" role="alert" style="display: none"></div>
    <div id="error_div" class="alert alert-danger" role="alert" style="display: none"></div>
  </div>
  <div id="plannerView">
    <div class="row justify-content-center mb-4">
      <div class="col-12 col-md-10 col-lg-8">
        <div class="card shadow-sm">
          <div class="card-body">
            <h2 class="card-title text-center mb-4">오늘의 묵주 기도</h2>
            <p class="text-center text-secondary mb-2">오늘 함께 바칠 신비를 선택해 보세요.</p>
            <p class="text-center text-muted small mb-4">월·토 환희 | 화·금 고통 | 수·일 영광 | 목요일 빛의 신비</p>
            <div class="row gy-3">
              <div class="col-12 col-sm-6">
                <div class="form-check border rounded p-3 h-100 d-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center">
                    <input class="form-check-input me-2" type="checkbox" value="환의의 신비" id="plannerJoyful">
                    <label class="form-check-label fw-semibold mb-0" for="plannerJoyful">
                      환의의 신비
                    </label>
                  </div>
                  <select class="form-select form-select-sm w-auto text-center" id="plannerJoyfulCount" aria-label="환의의 신비 단수 선택" disabled>
                    <option value="1">1단</option>
                    <option value="2">2단</option>
                    <option value="3">3단</option>
                    <option value="4">4단</option>
                    <option value="5" selected>5단</option>
                  </select>
                </div>
              </div>
              <div class="col-12 col-sm-6">
                <div class="form-check border rounded p-3 h-100 d-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center">
                    <input class="form-check-input me-2" type="checkbox" value="고통의 신비" id="plannerSorrowful">
                    <label class="form-check-label fw-semibold mb-0" for="plannerSorrowful">
                      고통의 신비
                    </label>
                  </div>
                  <select class="form-select form-select-sm w-auto text-center" id="plannerSorrowfulCount" aria-label="고통의 신비 단수 선택" disabled>
                    <option value="1">1단</option>
                    <option value="2">2단</option>
                    <option value="3">3단</option>
                    <option value="4">4단</option>
                    <option value="5" selected>5단</option>
                  </select>
                </div>
              </div>
              <div class="col-12 col-sm-6">
                <div class="form-check border rounded p-3 h-100 d-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center">
                    <input class="form-check-input me-2" type="checkbox" value="영광의 신비" id="plannerGlorious">
                    <label class="form-check-label fw-semibold mb-0" for="plannerGlorious">
                      영광의 신비
                    </label>
                  </div>
                  <select class="form-select form-select-sm w-auto text-center" id="plannerGloriousCount" aria-label="영광의 신비 단수 선택" disabled>
                    <option value="1">1단</option>
                    <option value="2">2단</option>
                    <option value="3">3단</option>
                    <option value="4">4단</option>
                    <option value="5" selected>5단</option>
                  </select>
                </div>
              </div>
              <div class="col-12 col-sm-6">
                <div class="form-check border rounded p-3 h-100 d-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center">
                    <input class="form-check-input me-2" type="checkbox" value="빛의 신비" id="plannerLuminous">
                    <label class="form-check-label fw-semibold mb-0" for="plannerLuminous">
                      빛의 신비
                    </label>
                  </div>
                  <select class="form-select form-select-sm w-auto text-center" id="plannerLuminousCount" aria-label="빛의 신비 단수 선택" disabled>
                    <option value="1">1단</option>
                    <option value="2">2단</option>
                    <option value="3">3단</option>
                    <option value="4">4단</option>
                    <option value="5" selected>5단</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="mt-4" id="plannerOptionsHome">
              <div class="border rounded" id="plannerOptionsWrapper">
                <button class="w-100 bg-transparent border-0 px-3 py-3 d-flex align-items-center justify-content-between" type="button" data-bs-toggle="collapse" data-bs-target="#plannerOptions" aria-expanded="false" aria-controls="plannerOptions">
                  <span class="fw-semibold">옵션</span>
                  <i class="bi bi-chevron-down" aria-hidden="true" id="plannerOptionsToggleIcon"></i>
                </button>
                <div class="collapse" id="plannerOptions">
                  <div class="border-top px-3 pb-3 pt-3">
                    <div class="form-check form-switch">
                      <input class="form-check-input" type="checkbox" role="switch" id="plannerOptionTts">
                      <label class="form-check-label" for="plannerOptionTts">TTS로 읽어 주기</label>
                    </div>
                  <div class="form-check form-switch mt-2">
                    <input class="form-check-input" type="checkbox" role="switch" id="plannerOptionAutoProgress">
                    <label class="form-check-label" for="plannerOptionAutoProgress">자동으로 진행 하기</label>
                  </div>
                  <div class="form-check form-switch mt-2">
                    <input class="form-check-input" type="checkbox" role="switch" id="plannerOptionVoiceAuto" disabled>
                    <label class="form-check-label d-flex align-items-center" for="plannerOptionVoiceAuto">
                      음성 인식으로 자동 진행 하기
                      <span class="badge bg-secondary ms-2">실험 기능</span>
                    </label>
                  </div>
                  <div class="form-check form-switch mt-2">
                    <input class="form-check-input" type="checkbox" role="switch" id="plannerOptionFullscreen">
                    <label class="form-check-label" for="plannerOptionFullscreen">전체 화면으로 보기</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
            <div class="d-grid mt-4">
              <button type="button" class="btn btn-primary btn-lg py-3" id="plannerStartButton" disabled>시작</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="prayerView" class="d-none">
    <div class="prayer-layout">
      <div class="prayer-pane-top position-relative">
        <div class="d-flex justify-content-between align-items-start p-4 h-100">
          <div class="prayer-metadata">
            <div class="d-flex align-items-baseline flex-wrap gap-2">
              <h3 class="fw-bold mb-0" id="prayerCurrentMystery">환의의 신비</h3>
              <div class="fw-semibold fs-5 text-muted" id="prayerCurrentDecade">1단</div>
            </div>
          </div>
          <button type="button" class="btn btn-outline-secondary btn-sm" id="prayerExitButton" aria-label="플래너로 돌아가기">
            <i class="bi bi-x-lg"></i>
          </button>
        </div>
        <div class="prayer-options-overlay position-absolute bottom-0 end-0 m-3" id="prayerOptionsOverlay">
        </div>
      </div>
      <div class="prayer-pane-bottom">
        <div class="prayer-lyric-area px-4 py-4">
          <p class="lead fw-semibold mb-2">기도문이 여기에 표시됩니다.</p>
          <p class="text-secondary">이 영역은 추후 묵주 기도문을 표시하기 위한 자리입니다.</p>
        </div>
      </div>
    </div>
  </div>
  <div id="mdrow" class="row">
  </div>
</main>
  <footer style="text-align: center" class="pt-2" id="mainFooter">
    <p class="fs-6"><small>평화를 빕니다! <a href="https://kcatholic-api.github.io/" target="_blank">한국어 가톨릭 API 프로젝트</a>를 방문하여 보세요.</small></p>
  </footer>
  </body>

<script>
function show_catch_phrase() {
  $("#menu_title").text("생각보다 은근히 평안한").fadeIn(500).delay(5000).fadeOut(500, show_menu_title);
}
function show_menu_title(fade=true) {
  if(fade)
    $("#menu_title").text("묵주 기도 도우미").fadeIn(500).delay(25000).fadeOut(500, show_catch_phrase);
  else
    $("#menu_title").text("묵주 기도 도우미").delay(25000).fadeOut(500, show_catch_phrase);
}

var startup_dialog_version = "kcatolic-api-sprp-startup-message-v1";
function never_see_startup() {
  localStorage.setItem(startup_dialog_version, "no");
}

function load_record() {
}

const plannerMysteryControls = [
  { checkbox: "#plannerJoyful", select: "#plannerJoyfulCount" },
  { checkbox: "#plannerSorrowful", select: "#plannerSorrowfulCount" },
  { checkbox: "#plannerGlorious", select: "#plannerGloriousCount" },
  { checkbox: "#plannerLuminous", select: "#plannerLuminousCount" }
];
const plannerCheckboxSelector = plannerMysteryControls.map((control) => control.checkbox).join(", ");
const settingsPrefix = "kcatolic-api-sprp-settings.";
let voiceAutoPreference = false;

function readSetting(key, defaultValue) {
  try {
    const raw = localStorage.getItem(settingsPrefix + key);
    if (raw === null) {
      return defaultValue;
    }
    return JSON.parse(raw);
  } catch (error) {
    console.warn("Failed to read setting", key, error);
    return defaultValue;
  }
}

function writeSetting(key, value) {
  try {
    localStorage.setItem(settingsPrefix + key, JSON.stringify(value));
  } catch (error) {
    console.warn("Failed to write setting", key, error);
  }
}

function select_default_mystery_for_today() {
  plannerMysteryControls.forEach(({ checkbox }) => {
    const element = $(checkbox);
    if (element.length) {
      element.prop("checked", false);
    }
  });

  const day = new Date().getDay();
  switch (day) {
    case 1: // Monday
    case 6: // Saturday
      $("#plannerJoyful").prop("checked", true);
      break;
    case 2: // Tuesday
    case 5: // Friday
      $("#plannerSorrowful").prop("checked", true);
      break;
    case 3: // Wednesday
    case 0: // Sunday
      $("#plannerGlorious").prop("checked", true);
      break;
    case 4: // Thursday
      $("#plannerLuminous").prop("checked", true);
      break;
    default:
      break;
  }
  update_mystery_count_states();
}

function update_planner_start_button() {
  const plannerCheckboxes = $(plannerCheckboxSelector);
  if (!plannerCheckboxes.length) {
    return;
  }
  const hasSelection = plannerCheckboxes.is(":checked");
  $("#plannerStartButton").prop("disabled", !hasSelection);
}

function update_mystery_count_states() {
  plannerMysteryControls.forEach(({ checkbox, select }) => {
    const checkboxElement = $(checkbox);
    const selectElement = $(select);
    if (!selectElement.length) {
      return;
    }
    const checked = checkboxElement.is(":checked");
    const wasDisabled = selectElement.prop("disabled");
    selectElement.prop("disabled", !checked);
    if (checked && wasDisabled) {
      selectElement.val("5");
    }
  });
}

function update_voice_auto_option() {
  const autoProgressCheckbox = $("#plannerOptionAutoProgress");
  const voiceAutoCheckbox = $("#plannerOptionVoiceAuto");
  if (!autoProgressCheckbox.length || !voiceAutoCheckbox.length) {
    return;
  }
  const enableVoiceAuto = autoProgressCheckbox.is(":checked");
  voiceAutoCheckbox.prop("disabled", !enableVoiceAuto);
  if (enableVoiceAuto) {
    voiceAutoCheckbox.prop("checked", voiceAutoPreference);
  } else {
    voiceAutoCheckbox.prop("checked", false);
  }
}

function load_option_settings() {
  const ttsPref = !!readSetting("option.tts", false);
  $("#plannerOptionTts").prop("checked", ttsPref);

  const autoPref = !!readSetting("option.autoProgress", false);
  $("#plannerOptionAutoProgress").prop("checked", autoPref);

  voiceAutoPreference = !!readSetting("option.voiceAuto", false);

  const fullscreenPref = !!readSetting("option.fullscreen", false);
  if (document.fullscreenElement) {
    $("#plannerOptionFullscreen").prop("checked", true);
  } else {
    $("#plannerOptionFullscreen").prop("checked", fullscreenPref);
  }

  update_voice_auto_option();
}

function init_option_collapse_icon() {
  const optionsCollapse = $("#plannerOptions");
  const toggleIcon = $("#plannerOptionsToggleIcon");
  if (!optionsCollapse.length || !toggleIcon.length) {
    return;
  }
  optionsCollapse.on("show.bs.collapse", function() {
    toggleIcon.removeClass("bi-chevron-down").addClass("bi-chevron-up");
  });
  optionsCollapse.on("hide.bs.collapse", function() {
    toggleIcon.removeClass("bi-chevron-up").addClass("bi-chevron-down");
  });
}

function toggle_fullscreen(enabled) {
  if (enabled) {
    if (!document.fullscreenElement && document.documentElement.requestFullscreen) {
      document.documentElement.requestFullscreen().catch(() => {
        $("#plannerOptionFullscreen").prop("checked", false);
        writeSetting("option.fullscreen", false);
      });
    }
  } else {
    if (document.fullscreenElement && document.exitFullscreen) {
      document.exitFullscreen().catch(() => {});
    }
  }
}

function sync_fullscreen_checkbox() {
  const checkbox = $("#plannerOptionFullscreen");
  if (!checkbox.length) {
    return;
  }
  checkbox.prop("checked", !!document.fullscreenElement);
  writeSetting("option.fullscreen", checkbox.is(":checked"));
}

document.addEventListener("fullscreenchange", sync_fullscreen_checkbox);

function reset_option_collapse_state() {
  const optionsCollapseElement = document.getElementById("plannerOptions");
  if (!optionsCollapseElement) {
    return;
  }
  const collapseInstance = bootstrap.Collapse.getInstance(optionsCollapseElement);
  if (collapseInstance) {
    collapseInstance.hide();
  } else {
    $(optionsCollapseElement).removeClass("show");
  }
  $("#plannerOptionsToggleIcon").removeClass("bi-chevron-up").addClass("bi-chevron-down");
}

function move_options_to_overlay() {
  const overlay = $("#prayerOptionsOverlay");
  const wrapper = $("#plannerOptionsWrapper");
  if (overlay.length && wrapper.length) {
    overlay.append(wrapper);
    reset_option_collapse_state();
  }
}

function move_options_to_planner() {
  const home = $("#plannerOptionsHome");
  const wrapper = $("#plannerOptionsWrapper");
  if (home.length && wrapper.length) {
    home.append(wrapper);
    reset_option_collapse_state();
  }
}

function get_first_selected_mystery() {
  for (const control of plannerMysteryControls) {
    const checkboxElement = $(control.checkbox);
    if (checkboxElement.length && checkboxElement.is(":checked")) {
      const labelText = checkboxElement.closest(".d-flex.align-items-center").find("label").text().trim();
      const decadeSelect = $(control.select);
      const decadeValue = decadeSelect.length ? decadeSelect.val() || "5" : "5";
      return {
        title: labelText || "묵주 기도",
        decade: `${decadeValue}단`
      };
    }
  }
  return {
    title: "묵주 기도",
    decade: "1단"
  };
}

function enter_prayer_view() {
  const { title, decade } = get_first_selected_mystery();
  $("#prayerCurrentMystery").text(title);
  $("#prayerCurrentDecade").text(decade);
  move_options_to_overlay();
  const wantsFullscreen = !!readSetting("option.fullscreen", false);
  if (wantsFullscreen && !document.fullscreenElement) {
    toggle_fullscreen(true);
  } else {
    sync_fullscreen_checkbox();
  }
  $("body").addClass("prayer-mode");
  $("#mainNavbar, #mainFooter").addClass("d-none");
  $("#plannerView").addClass("d-none");
  $("#prayerView").removeClass("d-none");
}

function exit_prayer_view() {
  move_options_to_planner();
  $("body").removeClass("prayer-mode");
  $("#mainNavbar, #mainFooter").removeClass("d-none");
  $("#prayerView").addClass("d-none");
  $("#plannerView").removeClass("d-none");
}

$(document).ready(function() {
  show_menu_title(false);
  select_default_mystery_for_today();
  load_option_settings();
  const plannerCheckboxes = $(plannerCheckboxSelector);
  plannerCheckboxes.on("change", function() {
    update_planner_start_button();
    update_mystery_count_states();
  });
  update_planner_start_button();
  update_mystery_count_states();
  $("#plannerOptionTts").on("change", function() {
    writeSetting("option.tts", $(this).is(":checked"));
  });
  $("#plannerOptionAutoProgress").on("change", function() {
    const enabled = $(this).is(":checked");
    writeSetting("option.autoProgress", enabled);
    update_voice_auto_option();
  });
  $("#plannerOptionVoiceAuto").on("change", function() {
    voiceAutoPreference = $(this).is(":checked");
    writeSetting("option.voiceAuto", voiceAutoPreference);
  });
  init_option_collapse_icon();
  $("#plannerOptionFullscreen").on("change", function() {
    const enabled = $(this).is(":checked");
    writeSetting("option.fullscreen", enabled);
    toggle_fullscreen(enabled);
  });
  $("#plannerStartButton").on("click", enter_prayer_view);
  $("#prayerExitButton").on("click", exit_prayer_view);

  if(window.location.hash == "") {
    if(localStorage.getItem(startup_dialog_version) != "no") {
      console.log("show startup");
      $("#startupModal").modal("show");
    }
  }
});

</script>

</html>
